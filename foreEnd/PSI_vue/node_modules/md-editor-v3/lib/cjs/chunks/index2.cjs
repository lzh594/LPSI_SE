"use strict";const o=require("vue"),g=require("./config.cjs"),u=require("./vue-tsx.cjs"),L={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},C=o.defineComponent({props:L,setup(e,i){const s=`${g.prefix}-dropdown-hidden`,t=o.reactive({overlayClass:[s],overlayStyle:{},triggerHover:!1,overlayHover:!1}),n=o.ref(),l=o.ref(),y=()=>{var p;t.triggerHover=!0;const r=n.value,a=l.value;if(!r||!a)return;const c=r.getBoundingClientRect(),f=r.offsetTop,S=r.offsetLeft,b=c.height,w=c.width,H=((p=document.querySelector(e.relative))==null?void 0:p.scrollLeft)||0;t.overlayStyle={...t.overlayStyle,top:f+b+"px",left:S-a.offsetWidth/2+w/2-H+"px"},e.onChange(!0)},m=()=>{t.overlayHover=!0};o.watch(()=>e.visible,r=>{r?t.overlayClass=t.overlayClass.filter(a=>a!==s):t.overlayClass.push(s)});let h=-1;const v=r=>{n.value===r.target?t.triggerHover=!1:t.overlayHover=!1,clearTimeout(h),h=window.setTimeout(()=>{!t.overlayHover&&!t.triggerHover&&e.onChange(!1)},10)};return o.onMounted(()=>{n.value.addEventListener("mouseenter",y),n.value.addEventListener("mouseleave",v),l.value.addEventListener("mouseenter",m),l.value.addEventListener("mouseleave",v)}),o.onBeforeUnmount(()=>{n.value.removeEventListener("mouseenter",y),n.value.removeEventListener("mouseleave",v),l.value.removeEventListener("mouseenter",m),l.value.removeEventListener("mouseleave",v)}),()=>{const r=u.getSlot({ctx:i}),a=u.getSlot({props:e,ctx:i},"overlay"),c=o.cloneVNode(r instanceof Array?r[0]:r,{ref:n}),f=o.createVNode("div",{class:[`${g.prefix}-dropdown`,t.overlayClass],style:t.overlayStyle,ref:l},[o.createVNode("div",{class:`${g.prefix}-dropdown-overlay`},[a instanceof Array?a[0]:a])]);return[c,f]}}}),E={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]}},d=o.defineComponent({name:"DropdownToolbar",props:E,emits:["onChange"],setup(e,i){const s=o.inject("editorId");return()=>{const t=u.getSlot({props:e,ctx:i},"trigger"),n=u.getSlot({props:e,ctx:i},"overlay");return o.createVNode(C,{relative:`#${s}-toolbar-wrapper`,visible:e.visible,onChange:l=>{e.onChange instanceof Function?e.onChange(l):i.emit("onChange",l)},overlay:n},{default:()=>[o.createVNode("div",{class:`${g.prefix}-toolbar-item`,title:e.title||""},[t])]})}}});d.install=e=>(e.component(d.name,d),e);exports.Dropdown=C;exports.DropdownToolbar=d;

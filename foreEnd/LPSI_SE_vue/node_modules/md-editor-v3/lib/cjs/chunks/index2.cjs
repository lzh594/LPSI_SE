"use strict";const o=require("vue"),d=require("./config.cjs"),g=require("./vue-tsx.cjs"),L={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},S=o.defineComponent({props:L,setup(e,i){const s=`${d.prefix}-dropdown-hidden`,t=o.reactive({overlayClass:[s],overlayStyle:{},triggerHover:!1,overlayHover:!1}),n=o.ref(),l=o.ref(),v=()=>{var h;t.triggerHover=!0;const r=n.value,a=l.value;if(!r||!a)return;const u=r.getBoundingClientRect(),y=r.offsetTop,C=r.offsetLeft,b=u.height,w=u.width,H=((h=document.querySelector(e.relative))==null?void 0:h.scrollLeft)||0;t.overlayStyle={...t.overlayStyle,top:y+b+"px",left:C-a.offsetWidth/2+w/2-H+"px"},e.onChange(!0)},m=()=>{t.overlayHover=!0};o.watch(()=>e.visible,r=>{r?t.overlayClass=t.overlayClass.filter(a=>a!==s):t.overlayClass.push(s)});let p=-1;const c=r=>{n.value===r.target?t.triggerHover=!1:t.overlayHover=!1,clearTimeout(p),p=window.setTimeout(()=>{!t.overlayHover&&!t.triggerHover&&e.onChange(!1)},10)};return o.onMounted(()=>{n.value.addEventListener("mouseenter",v),n.value.addEventListener("mouseleave",c),l.value.addEventListener("mouseenter",m),l.value.addEventListener("mouseleave",c)}),o.onBeforeUnmount(()=>{n.value.removeEventListener("mouseenter",v),n.value.removeEventListener("mouseleave",c),l.value.removeEventListener("mouseenter",m),l.value.removeEventListener("mouseleave",c)}),()=>{const r=g.getSlot({ctx:i}),a=g.getSlot({props:e,ctx:i},"overlay"),u=o.cloneVNode(r instanceof Array?r[0]:r,{ref:n}),y=o.createVNode("div",{class:[`${d.prefix}-dropdown`,t.overlayClass],style:t.overlayStyle,ref:l},[o.createVNode("div",{class:`${d.prefix}-dropdown-overlay`},[a instanceof Array?a[0]:a])]);return[u,y]}}}),E={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},default:{type:[String,Object]}},f=o.defineComponent({name:"DropdownToolbar",props:E,emits:["onChange"],setup(e,i){const s=o.inject("editorId");return()=>{const t=g.getSlot({props:e,ctx:i},"trigger"),n=g.getSlot({props:e,ctx:i},"overlay"),l=g.getSlot({props:e,ctx:i});return o.createVNode(S,{relative:`#${s}-toolbar-wrapper`,visible:e.visible,onChange:v=>{e.onChange instanceof Function?e.onChange(v):i.emit("onChange",v)},overlay:n},{default:()=>[o.createVNode("div",{class:`${d.prefix}-toolbar-item`,title:e.title||""},[t,l])]})}}});f.install=e=>(e.component(f.name,f),e);exports.Dropdown=S;exports.DropdownToolbar=f;
